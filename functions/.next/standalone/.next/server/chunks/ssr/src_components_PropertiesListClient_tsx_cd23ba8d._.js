module.exports=[80013,a=>{"use strict";a.s(["default",()=>s],80013);var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(8876),f=a.i(50944),g=a.i(99570),h=a.i(66718),i=a.i(80701),j=a.i(91119),k=a.i(86304),l=a.i(33508),m=a.i(70106);let n=(0,m.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var o=a.i(71111);function p({cities:a,districts:d}){let e=(0,f.useRouter)(),m=(0,f.useSearchParams)(),[p,q]=(0,c.useState)({city:m.get("city")||"",district:m.get("district")||"",type:m.get("type")||"",purpose:m.get("purpose")||"",status:m.get("status")||"",minPrice:m.get("minPrice")||"",maxPrice:m.get("maxPrice")||"",minArea:m.get("minArea")||"",maxArea:m.get("maxArea")||"",bedrooms:m.get("bedrooms")||"",bathrooms:m.get("bathrooms")||""}),[r,s]=(0,c.useState)(!1),t=a=>{let b={...p,...a};q(b);let c=new URLSearchParams;Object.entries(b).forEach(([a,b])=>{b&&c.set(a,b)}),e.push(`/properties?${c.toString()}`)},u=Object.values(p).filter(a=>a).length;return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>s(!r),className:"flex items-center gap-2",children:[(0,b.jsx)(n,{className:"h-4 w-4"}),"فلاتر البحث",u>0&&(0,b.jsx)(k.Badge,{variant:"secondary",className:"mr-2",children:u})]}),u>0&&(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>{q({city:"",district:"",type:"",purpose:"",status:"",minPrice:"",maxPrice:"",minArea:"",maxArea:"",bedrooms:"",bathrooms:""}),e.push("/properties")},size:"sm",children:[(0,b.jsx)(l.X,{className:"h-4 w-4 ml-2"}),"مسح الفلاتر"]})]}),r&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"فلاتر البحث"})}),(0,b.jsx)(j.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"المدينة"}),(0,b.jsxs)(i.Select,{value:p.city,onValueChange:a=>t({city:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر المدينة"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع المدن"}),a.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"الحي"}),(0,b.jsxs)(i.Select,{value:p.district,onValueChange:a=>t({district:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر الحي"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع الأحياء"}),d.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"نوع العقار"}),(0,b.jsxs)(i.Select,{value:p.type,onValueChange:a=>t({type:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر النوع"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع الأنواع"}),Object.entries(o.PROPERTY_TYPE_LABELS).map(([a,c])=>(0,b.jsx)(i.SelectItem,{value:a,children:c},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"نوع المعاملة"}),(0,b.jsxs)(i.Select,{value:p.purpose,onValueChange:a=>t({purpose:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر المعاملة"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع المعاملات"}),Object.entries(o.PROPERTY_PURPOSE_LABELS).map(([a,c])=>(0,b.jsx)(i.SelectItem,{value:a,children:c},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"الحالة"}),(0,b.jsxs)(i.Select,{value:p.status,onValueChange:a=>t({status:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر الحالة"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع الحالات"}),Object.entries(o.PROPERTY_STATUS_LABELS).map(([a,c])=>(0,b.jsx)(i.SelectItem,{value:a,children:c},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"غرف النوم"}),(0,b.jsxs)(i.Select,{value:p.bedrooms,onValueChange:a=>t({bedrooms:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر العدد"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع الأعداد"}),[1,2,3,4,5,6,7,8,9,10].map(a=>(0,b.jsxs)(i.SelectItem,{value:a.toString(),children:[a,"+ غرف"]},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"دورات المياه"}),(0,b.jsxs)(i.Select,{value:p.bathrooms,onValueChange:a=>t({bathrooms:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"اختر العدد"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"جميع الأعداد"}),[1,2,3,4,5,6,7,8].map(a=>(0,b.jsxs)(i.SelectItem,{value:a.toString(),children:[a,"+ دورات مياه"]},a))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"السعر (ريال)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Input,{type:"number",placeholder:"من",value:p.minPrice,onChange:a=>t({minPrice:a.target.value})}),(0,b.jsx)(h.Input,{type:"number",placeholder:"إلى",value:p.maxPrice,onChange:a=>t({maxPrice:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"المساحة (م²)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Input,{type:"number",placeholder:"من",value:p.minArea,onChange:a=>t({minArea:a.target.value})}),(0,b.jsx)(h.Input,{type:"number",placeholder:"إلى",value:p.maxArea,onChange:a=>t({maxArea:a.target.value})})]})]})]})})]})]})}var q=a.i(85167);let r=(0,m.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);function s({searchParams:a}){let[f,h]=(0,c.useState)(!0),[i,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),s=(0,c.useMemo)(()=>{if(console.log("PropertiesListClient: Raw searchParams:",a),"string"==typeof a)return Object.fromEntries(new URLSearchParams(a).entries());if(a&&"object"==typeof a){let b=new URLSearchParams;return Object.entries(a).forEach(([a,c])=>{"string"==typeof c?b.set(a,c):Array.isArray(c)&&b.set(a,c[0])}),Object.fromEntries(b.entries())}return{}},[a]);return((0,c.useEffect)(()=>{let a=!0;return async function(){h(!0);try{console.log("PropertiesListClient: Starting fetchData"),console.log("PropertiesListClient: Firebase db:",e.db);let b=(0,d.query)((0,d.collection)(e.db,"properties"));console.log("PropertiesListClient: Base query created"),s.city&&(console.log("PropertiesListClient: Adding city filter:",s.city),b=(0,d.query)(b,(0,d.where)("city","==",s.city))),s.district&&(console.log("PropertiesListClient: Adding district filter:",s.district),b=(0,d.query)(b,(0,d.where)("district","==",s.district))),s.type&&(console.log("PropertiesListClient: Adding type filter:",s.type),b=(0,d.query)(b,(0,d.where)("type","==",s.type))),s.purpose&&(console.log("PropertiesListClient: Adding purpose filter:",s.purpose),b=(0,d.query)(b,(0,d.where)("purpose","==",s.purpose))),s.status&&(console.log("PropertiesListClient: Adding status filter:",s.status),b=(0,d.query)(b,(0,d.where)("status","==",s.status)));let c=await (0,d.getDocs)(b);console.log("PropertiesListClient: Found",c.docs.length,"properties"),console.log("PropertiesListClient: Filters applied:",s);let f=c.docs.map(a=>{let b=a.data(),c={id:a.id,...b,price:Number(b.price)||0,areaM2:b.areaM2?Number(b.areaM2):void 0,bedrooms:b.bedrooms?Number(b.bedrooms):void 0,bathrooms:b.bathrooms?Number(b.bathrooms):void 0,floor:b.floor?Number(b.floor):void 0,yearBuilt:b.yearBuilt?Number(b.yearBuilt):void 0,lat:b.lat?Number(b.lat):void 0,lng:b.lng?Number(b.lng):void 0,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date};return console.log("PropertiesListClient: Property:",c.titleAr,c.status),c});if(f.sort((a,b)=>{let c=a.updatedAt?.getTime()||0;return(b.updatedAt?.getTime()||0)-c}),s.minPrice&&(f=f.filter(a=>a.price>=Number(s.minPrice))),s.maxPrice&&(f=f.filter(a=>a.price<=Number(s.maxPrice))),s.minArea&&(f=f.filter(a=>a.areaM2&&a.areaM2>=Number(s.minArea))),s.maxArea&&(f=f.filter(a=>a.areaM2&&a.areaM2<=Number(s.maxArea))),s.bedrooms&&(f=f.filter(a=>a.bedrooms&&a.bedrooms>=Number(s.bedrooms))),s.bathrooms&&(f=f.filter(a=>a.bathrooms&&a.bathrooms>=Number(s.bathrooms))),console.log("PropertiesListClient: After filters:",f.length,"properties remain"),console.log("PropertiesListClient: Final properties:",f.map(a=>({title:a.titleAr,status:a.status}))),!a)return;k(f);let g=new Set,h=new Set;f.forEach(a=>{a.city&&g.add(a.city),a.district&&h.add(a.district)}),m(Array.from(g).sort()),o(Array.from(h).sort())}catch(a){console.error("PropertiesListClient: Error fetching properties:",a),console.error("PropertiesListClient: Error details:",{message:a instanceof Error?a.message:"Unknown error",stack:a instanceof Error?a.stack:void 0,name:a instanceof Error?a.name:void 0})}finally{a&&h(!1)}}(),()=>{a=!1}},[s]),f)?(0,b.jsx)(j.Card,{children:(0,b.jsx)(j.CardContent,{className:"p-6 text-center",children:"جاري التحميل..."})}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(p,{cities:l,districts:n}),0===i.length?(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(r,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد عقارات"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"لم نجد أي عقارات تطابق معايير البحث الخاصة بك"}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>window.location.href="/properties",children:"مسح الفلاتر"})})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(a=>(0,b.jsx)(q.default,{property:a},a.id))})]})}}];

//# sourceMappingURL=src_components_PropertiesListClient_tsx_cd23ba8d._.js.map